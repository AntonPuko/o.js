function o(e){function n(){for(var e,n={},t=0,r=arguments.length;r>t;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&(n[e]=arguments[t][e]);return n}return base=this,base.oConfig=base.oConfig||{endpoint:null,format:"json",version:4,strictMode:!0,start:null,ready:null,error:null,headers:[],username:null,password:null,isAsync:!0,isCors:!0,openAjaxRequests:0,isHashRoute:!0},base.config=function(e){base.oConfig=n(base.oConfig,e)},base.isEndpoint=function(){return null!==base.oConfig.endpoint},"undefined"==typeof e?base:new oData(e,base.oConfig)}function oData(e,n){function t(e,n,t,r){if(P(n)){var o="",a=[];for(i=0;i<n.length;++i)a[i]="("+e+" "+t+" "+n[i][e]+")";return o=a.join(" "+r+" ")}return""}function r(e,n,t){for(var t=t||(4==oConfig.version?"contains":"substringof"),r=n.split(" "),o="contains"===t||"substringof"===t,a=[],i=0;i<e.length;i++){var u=[];if(o)for(var s=0;s<r.length;s++)u.push(4==oConfig.version?t+"("+e[i]+",'"+r[s]+"')":t+"('"+r[s]+"',"+e[i]+")");else u.push(e[i]+" "+t+" '"+n+"'");a.push("("+u.join(" and ")+")")}return a.join("or")}function o(e){var n=e||Y;n&&0!==n.path.length||N('No resource defined. Define a resource first with o("YourResourcePath").');var t="";M&&(t=base.oConfig.endpoint+(A(base.oConfig.endpoint,"/")?"":"/"));for(var r=0;r<n.path.length;r++)t+=n.path[r].resource,n.path[r].get&&(t+="("+(W[n.path[r].get]||n.path[r].get)+")"),t+="/";return t+n.appending+a()}function a(){var e="";for(queryName in Y.query)Y.query.hasOwnProperty(queryName)&&null!=Y.query[queryName]&&(e+="&"+Y.queryList[Y.query[queryName]].name+"="+_(Y.queryList[Y.query[queryName]].value,W));return e.length>0?"?"+e.substring(1):""}function u(e){for(var n=0;n<G.length;n++)if(G[n].route.regex.test(e)){W={};var t={},r=G[n].route.regex.exec(e);if("undefined"!=typeof G[n].route.param){var o=1;for(prop in G[n].route.param)W[prop]=r[o],t[prop.substring(1)]=r[o],o++}else for(var o=1;o<r.length;o++)W[":"+(o-1)]=r[o],t[o-1]=r[o];z(t)||h(G[n].callback,t)}}function s(e){var n=e;if(!(e instanceof RegExp)){oConfig.isHashRoute&&!R(e,"#")&&(e="#"+e);for(var t=e.split("/"),r={},o=0;o<t.length;o++)R(t[o],":")&&(r[t[o]]=!0,t[o]="(\\w+|\\W+)");n=new RegExp("^"+t.join("/")+"$")}return{regex:n,param:r}}function f(e){return JSON?JSON.parse(JSON.stringify(e)):void N("No JSON Support.")}function l(e){var n=new RegExp("'.*?'",""),t=n.exec(e);e=e.replace(n,"{0}");for(key in F)e=e.split(key).join(" "+F[key]+" ");if(null!=t)for(var r=0;r<t.length;r++)e=e.replace("{0}",t[r]);return e}function d(e){Y&&B.push(Y),Y="string"==typeof e?y(e):e,T("$format")||v("$format",base.oConfig.format)}function c(e,n,t,r){if(null===Y&&N('You must define a resource to perform a get(), post(), put() or delete() function. Define a resource with o("YourODataResource").'),0!==B.length||t){B.push(Y);var a=j(Y.method,o());if(w(["POST","PATCH","DELETE"])<=1&&t&&!X)k(a,E(Y.data),e,n,!1,[{name:"Accept",value:"application/json"},{name:"Content-Type",value:"application/json"},{name:"Content-Length",value:E(Y.data).length}]),O(["POST","PATCH","DELETE"]);else{var i=q();k(j("POST",base.oConfig.endpoint+(A(base.oConfig.endpoint,"/")?"":"/")+"$batch"),L(i,t),e,n,!0,[{name:"Content-Type",value:"multipart/mixed; boundary=batch_"+i}]),t&&O(["POST","PUT","DELETE"])}}else k(j("GET",o()),null,e,n,!1,null,r)}function h(e,n){""!==Y.path[0].resource?c(e,null,!1,n):e.call(base,n)}function g(e){return"undefined"==typeof e?base:(e.toUpperCase().indexOf("HTTP://")>-1||e.toUpperCase().indexOf("HTTPS://")>-1?M=!1:base.oConfig.endpoint||N("You can not use resource query without defining your oData endpoint. Use o().config({endpoint:youeEndpoint}) to define your oData endpoint."),routeName=e,d(e),base)}function b(e){T("$expand")?(Y.queryList[Y.query.$expand].value+=","+e,Y.queryList[Y.query.$expand].original=Y.queryList[Y.query.$expand].value):v("$expand",e,e)}function y(e){var n=e.split("?"),t=e,r="",o={path:[],appending:"",query:{},queryList:[],method:"GET",data:null};if(2===n.length){t=n[0],r=n[1];for(var a=r.split("&"),i=0;i<a.length;i++){var u=a[i].split("=");o.queryList.push({name:u[0],value:u[1]}),o.query[u[0]]=o.queryList.length-1}}for(var s=t.split("/"),i=0;i<s.length;i++)if(R(s[i],"$")&&"$link"!==s[i])o.appending=s[i];else{var f=s[i].split("(");o.path.push(1===f.length?{resource:s[i],get:null}:{resource:f[0],get:f[1].substring(0,f[1].length-1)})}return o}function v(e,n,t,r){t=t||null,Y.queryList.push({name:e,value:n,original:t}),Y.query[r||e]=Y.queryList.length-1}function m(e,n,t,r,o){t=t||null,r=r||" or ",e=o||e,Y.queryList[Y.query[e]].value="("+Y.queryList[Y.query[e]].value+")"+r+"("+n+")",t&&(Y.queryList[Y.query[e]].original=Y.queryList[Y.query[e]].value)}function C(e){Y.query[e]=null}function x(e){if(T(e)){var n=e;return P(n)&&(n=n.join(",")),N("There is already a depending query. You can not use them together/twice: "+n),!0}return!1}function T(e){for(var n=P(e)?e:[e],t=!1,r=0;r<n.length;r++)Y.query.hasOwnProperty(n[r])&&(t=!0);return t}function q(){var e=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==n?t:7&t|8).toString(16)});return n}function $(e,n){return"undefined"!=typeof e&&null!==e&&e.length>0?e:void N(n+": Parameter must be set.")}function S(e,n){if("number"==typeof e)return e;var t=n;return e&&e.length>0&&(isNaN(e)||(t=parseInt(e))),t}function w(e){for(var n=0,t=0;t<B.length;t++)e.indexOf(B[t].method)>-1&&n++;return n}function O(e){for(var n=[],t=0;t<B.length;t++)e.indexOf(B[t].method)>-1&&n.push(t);for(var t=n.length-1;t>=0;t--)B.splice(n[t],1);B[0]&&(Y=B[0])}function E(e){return JSON?JSON.stringify(e):(N("No JSON support."),e)}function P(e){return"undefined"==typeof Array.isArray?"[object Array]"===e.toString():Array.isArray(e)}function A(e,n){return e?-1!==e.indexOf(n,e.length-n.length):!1}function R(e,n){return 0===e.indexOf(n)}function N(e){function n(e){this.message=e,this.name="o.js exception"}if(n.prototype=new Error,base.oConfig.strictMode===!0)throw new n(e);console.log("o.js exception: "+e)}function L(e,n){var t="",r=q(),a=!1;n&&(t+="--batch_"+e+"\n",t+="Content-Type: multipart/mixed; boundary=changeset_"+r+"\n\n");for(var i=0;i<B.length;i++){var u=B[i];if(Y=u,"GET"!==u.method||n){if(("POST"===u.method||"PUT"===u.method||"PATCH"===u.method||"DELETE"===u.method)&&n){var s=E(u.data);t+="--changeset_"+r+"\n",t+="Content-Type: application/http\n",t+="Content-Transfer-Encoding: binary\n",t+="Content-ID:"+i+"1\n\n",t+=u.method+" "+o(u)+" HTTP/1.1\n",t+="Host: "+base.oConfig.endpoint+"\n",t+="Content-Type: application/json\n",t+="Content-Length:"+s.length+"\n\n",t+=E(Y.data)+"\n\n\n",a=!0}}else t+="--batch_"+e+"\n",t+="Content-Type: application/http\n",t+="Content-Transfer-Encoding: binary\n\n",t+=u.method+" "+o(u)+" HTTP/1.1\n",t+="Host: "+base.oConfig.endpoint+"\n\n"}return a&&(t+="--changeset_"+r+"--\n\n"),t+="--batch_"+e+"--"}function k(e,n,t,r,a,i,u){base.oConfig.start&&null==I&&(base.oConfig.openAjaxRequests++,base.oConfig.start()),I&&I[0]&&I[0](!0);var s=base;if(X&&(e.onload=function(){e.readyState=4,e.status=200,e.onreadystatechange()},e.onerror=function(){e.readyState=0,e.status=400,e.onreadystatechange()}),e.onreadystatechange=function(){if(4===e.readyState){if(e.status>=200&&e.status<300){if(204===e.status);else if(a){for(var n=e.responseText.split("\n"),i=0,f=[],l=0;l<n.length;l++)R(n[l],"{")&&(H(n[l],s),f.push(s.data),i++);s.data=f}else H(e.responseText,s);U&&U.resolve(s),"function"==typeof t&&t.call(s,s.data,u)}else try{var p=e.responseText;if(JSON&&""!=e.responseText&&(p=JSON.parse(e.responseText)),""!==p&&p["odata.error"]){var d=p["odata.error"].message.value+" | HTTP Status: "+e.status+" | oData Code: "+p["odata.error"].code;N(d)}else N("Request to "+o()+" failed with HTTP status "+(e.status||404)+".")}catch(c){if(D(s,!0,e.status),"undefined"!=typeof r)r(e.status||404,c);else{if(!U)throw c;c.status=e.status||404,U.reject(c)}}D(s,!1)}},base.oConfig.username&&base.oConfig.password&&(X&&N("CORS and Basic Auth is not supported for IE <= 9. Try to set isCors:false in the OData config if you do not need CORS support."),e.setRequestHeader("Authorization","Basic "+J(base.oConfig.username+":"+base.oConfig.password))),!X){if(i)for(var f=0;f<i.length;f++)e.setRequestHeader(i[f].name,i[f].value);if(base.oConfig.headers.length>0)for(var f=0;f<base.oConfig.headers.length;f++)e.setRequestHeader(base.oConfig.headers[f].name,base.oConfig.headers[f].value)}e.send(n)}function D(e,n,t){e.oConfig.ready&&null==I&&(e.oConfig.openAjaxRequests--,e.oConfig.openAjaxRequests<=0&&e.oConfig.ready()),I&&I[1]&&I[1](!1),e.oConfig.error&&n&&e.oConfig.error(t)}function H(e,n){var t=S(e,-1);if(-1!==t)n.data=t;else if(JSON){var r=JSON.parse(e);r.hasOwnProperty("value")?(n.data=T(["$first"])&&r.value.length&&r.value.length<=1?r.value[0]:r.value,(r.hasOwnProperty("odata.count")||r.hasOwnProperty("@odata.count"))&&(n.inlinecount=r["odata.count"]||r["@odata.count"])):n.data=r,Y.data=n.data}else n.data=e}function j(e,n){var t=new XMLHttpRequest;return base.oConfig.isCors&&"withCredentials"in t?t.open(e,n,base.oConfig.isAsync):base.oConfig.isCors&&"undefined"!=typeof XDomainRequest?(t=new XDomainRequest,X=!0,"GET"==e?t.open(e,n):t.open("POST",n)):t.open(e,n,base.oConfig.isAsync),t}function _(){var e=arguments[0],n=arguments[1];for(p in n){var t=new RegExp(p,"g");e=e.replace(t,n[p])}return e}function J(e){var n={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,o,a,i,u,s,f="",l=0;for(e=n._utf8_encode(e);l<e.length;)t=e.charCodeAt(l++),r=e.charCodeAt(l++),o=e.charCodeAt(l++),a=t>>2,i=(3&t)<<4|r>>4,u=(15&r)<<2|o>>6,s=63&o,isNaN(r)?u=s=64:isNaN(o)&&(s=64),f=f+this._keyStr.charAt(a)+this._keyStr.charAt(i)+this._keyStr.charAt(u)+this._keyStr.charAt(s);return f},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var n="",t=0;t<e.length;t++){var r=e.charCodeAt(t);128>r?n+=String.fromCharCode(r):r>127&&2048>r?(n+=String.fromCharCode(r>>6|192),n+=String.fromCharCode(63&r|128)):(n+=String.fromCharCode(r>>12|224),n+=String.fromCharCode(r>>6&63|128),n+=String.fromCharCode(63&r|128))}return n}};return n.encode(e)}base=this;var Y=null,B=[],G=[],M=!0,U=null,I=null,X=!1,z=function(){},W={},F={"==":"eq","===":"eq","!=":"ne","!==":"ne",">":"gt",">=":"ge","<":"lt","<=":"le","&&":"and","||":"or","!":"not","+":"add","-":"sub","*":"mul",".":"/","%":"mod"};return base.data=[],base.inlinecount=null,base.param={},base.oConfig=n,base.routes=base.route=function(e,n){P(e)||(e=[e]);for(var t=window.location.hash,r=0;r<e.length;r++)"undefined"!=typeof n?G.push({name:e[r],route:s(e[r]),callback:n,param:{},interval:setInterval(function(){window.location.hash!=t&&(t=window.location.hash,u(window.location.hash))},100)}):N('Routes without a callback are not supported. Please define a function like .route("YourRoute", function() { }).');return base.triggerRoute(window.location.hash),base},base.beforeRouting=function(e){return z=e,base},base.isEndpoint=function(){return M},base.triggerRoute=function(e){return u(e),base},base.find=function(e){return Y.path[Y.path.length-1].get=e,base},base.top=base.take=function(e){return x(["$top"])||v("$top",e,e),base},base.skip=function(e){return x("$skip")||v("$skip",e,e),base},base.first=function(){return x(["$top","$first"])||v("$top",1,null,"$first"),base},base.filter=function(e){var n=$(l(e));return T("$filter")?m("$filter",n,n):v("$filter",n,n),base},base.any=function(e,n){var t=e+"/any(x:x/"+l($(n))+")";return T("$filter")?m("$filter",t,t):v("$filter",t,t),base},base.orderBy=function(e){return x("$orderby")||v("$orderby",$(e)),base},base.select=function(e){return v("$select",$(e)),base},base.count=function(){return C("$format"),Y.appending="$count",base},base.inlineCount=function(e){return 4==oConfig.version?(e=e||"true",x("$count")||v("$count",e)):(e=e||"allpages",x("$inlinecount")||v("$inlinecount",e)),base},base.batch=function(e){return d(e),base},base.expand=function(e){return b(e),base},base.loading=function(e,n){return n=n||e,I=e?[e,n]:[function(){},function(){}],base},base.ref=base.link=function(e,n){C("$format"),(null==Y||Y.get)&&N("You need to define a resource with the find() method to append an navigation property"),oConfig.version<4?(Y.method="POST",Y.path.push("$link"),Y.path.push({resource:e,get:null})):(Y.method="POST",Y.path.push({resource:e,get:null}),Y.appending="$ref");var t=y(e);t.path[t.path.length-1].get=n;var r=o(t);return Y.data={"@odata.id":r.substring(0,r.length-1)},base},base.removeRef=base.deleteRef=function(e,n){if(C("$format"),(null==Y||Y.get)&&N("You need to define a resource with the find() method to append an navigation property"),oConfig.version<4?(Y.method="POST",Y.path.push("$link"),Y.path.push({resource:e,get:null})):(Y.method="POST",Y.path.push({resource:e,get:null}),Y.appending="$ref"),n){var t=y(e);t.path[t.path.length-1].get=n;var r=o(t);v("$id",r.substring(0,r.length-1))}return Y.method="DELETE",base},base.get=function(e,n){return"undefined"!=typeof Q&&(U=Q.defer()),c(e,n,!1),"undefined"!=typeof Q?U.promise:base},base.save=function(e,n){if("GET"===Y.method&&null!==Y.data){var t=f(Y);t.method="PATCH",t.data=Y.data,d(t)}return U||"undefined"==typeof e?(U=Q.defer(),c(e,n,!0),U.promise):(c(e,n,!0),base)},base.post=function(e,n){return C("$format"),n&&d(n),Y.method="POST",Y.data=e,base},base.patch=base.put=function(e,n){return n&&d(n),Y.path[0]&&Y.path[0].get||N("Bulk updates are not supported. You need to query a unique resource with find() to patch/put it."),Y.method="PATCH",Y.data=e,base},base.remove=base["delete"]=function(e){return e&&d(e),Y.path[0]&&Y.path[0].get||N("Bulk deletes are not supported. You need to query a unique resource with find() to delete it."),Y.method="DELETE",base},base.query=function(e){return o(e)},base.search=function(e,n,t,o){var a=r(e,n,t);return 4==oConfig.version&&o?x("$search")||v("$search",a,a):x("$filter")||v("$filter",a,a,"$search"),base},base.filterByList=base.exclude=function(e,n){if(!x("$filter")){var r=t(e,n,F["!="],F["&&"]);v("$filter",$(r),r)}return base},base.include=function(e,n){if(!x("$filter")){var r=t(e,n,F["=="],F["||"]);v("$filter",$(r),r)}return base},g(e)}
